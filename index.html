<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Expenses Calculator - Janasena Enterprises</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<body>
    <h1>Janasena Enterprises - Business Expenses Calculator</h1>
    <div class="menu">
        <button onclick="showSection('dailyWages')">Daily Wages</button>
        <button onclick="showSection('dailyExpenses')">Daily Expenses</button>
        <button onclick="showSection('report')">Report</button>
    </div>

    <!-- Daily Wages Section -->
    <div id="dailyWages" class="section">
        <h2>Daily Wages</h2>
        <label for="wageDate">Select Date: </label>
        <input type="date" id="wageDate">
        <label for="numWorkers">Number of Workers: </label>
        <input type="number" id="numWorkers" value="1" min="1">
        <button onclick="addWorkerFields()">Add Workers</button>

        <div id="workersContainer"></div>
        
        <label for="pricePerKg">Price per Kilogram: </label>
        <input type="number" id="pricePerKg" step="0.01" min="0">
        
        <button onclick="calculateWages()">Calculate Total Wages</button>
        <button onclick="exportToExcel()">Export to Excel</button>
        
        <p id="wagesOutput"></p>
        <table id="wagesTable" style="display: none; width: 100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th>Worker ID</th>
                    <th>Work Description</th>
                    <th>Kilograms Worked</th>
                    <th>Pay</th>
                </tr>
            </thead>
            <tbody id="wagesTableBody"></tbody>
        </table>
    </div>

    <!-- Daily Expenses Section -->
    <div id="dailyExpenses" class="section">
        <h2>Daily Expenses</h2>
        <label for="expenseDate">Select Date: </label>
        <input type="date" id="expenseDate">
        <label for="expenseDesc">Expense Description: </label>
        <input type="text" id="expenseDesc">
        <label for="expenseAmount">Amount: </label>
        <input type="number" id="expenseAmount" min="0">
        <button onclick="addExpense()">Add Expense</button>

        <ul id="expensesList"></ul>
        <button onclick="calculateExpenses()">Calculate Total Expenses</button>
        <button onclick="exportExpensesToExcel()">Export Expenses to Excel</button>
        <p id="expensesOutput"></p>
    </div>

    <!-- Report Section -->
    <div id="report" class="section">
        <h2>Report</h2>
        <label for="reportDate">Select Date: </label>
        <input type="date" id="reportDate">
        <button onclick="generateReport()">Generate Report</button>
        <p id="reportOutput">No data yet.</p>
    </div>

    <script src="script.js"></script>
</body>
</html>
